<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Microsoft.Scripting.Hosting.Shell.Remote Namespace</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Microsoft.Scripting.Hosting.Shell.Remote namespace" /><meta name="Microsoft.Help.F1" content="Microsoft.Scripting.Hosting.Shell.Remote" /><meta name="Microsoft.Help.Id" content="N:Microsoft.Scripting.Hosting.Shell.Remote" /><meta name="Description" content="summaryN:Microsoft.Scripting.Hosting.Shell.Remote" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Microsoft.Scripting.Hosting.Shell.Remote" /><meta name="file" content="dc1f32d1-0fb9-7ab3-77de-b424c8b3db4c" /><meta name="guid" content="dc1f32d1-0fb9-7ab3-77de-b424c8b3db4c" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">A Sandcastle Documented Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\5c40d2a7-638e-43e6-8a88-431a59427f20.htm" title="A Sandcastle Documented Class Library" tocid="roottoc">A Sandcastle Documented Class Library</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/dc1f32d1-0fb9-7ab3-77de-b424c8b3db4c.htm" title="Microsoft.Scripting.Hosting.Shell.Remote" tocid="dc1f32d1-0fb9-7ab3-77de-b424c8b3db4c">Microsoft.Scripting.Hosting.Shell.Remote</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/ae0e5e2a-5ad1-8d76-e0b7-9f9d8832827d.htm" title="ConsoleRestartManager Class" tocid="ae0e5e2a-5ad1-8d76-e0b7-9f9d8832827d">ConsoleRestartManager Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/b867173c-778a-76e4-9f90-da072efb4077.htm" title="RemoteCommandDispatcher Class" tocid="b867173c-778a-76e4-9f90-da072efb4077">RemoteCommandDispatcher Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/4d7ab5b8-e07c-ff48-a0ef-32c826d21028.htm" title="RemoteConsoleCommandLine Class" tocid="4d7ab5b8-e07c-ff48-a0ef-32c826d21028">RemoteConsoleCommandLine Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/f828daf1-9ccf-970c-4f90-54658f5e460b.htm" title="RemoteConsoleHost Class" tocid="f828daf1-9ccf-970c-4f90-54658f5e460b">RemoteConsoleHost Class</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/3ac8a09f-18fa-4a1a-5130-d3242ae3395b.htm" title="RemoteRuntimeServer Class" tocid="3ac8a09f-18fa-4a1a-5130-d3242ae3395b">RemoteRuntimeServer Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/eac12032-59f7-5620-9a79-200ed2b51842.htm" title="RemoteRuntimeStartupException Class" tocid="eac12032-59f7-5620-9a79-200ed2b51842">RemoteRuntimeStartupException Class</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Microsoft.Scripting.Hosting.Shell.Remote Namespace</h1></td></tr></table><span class="introStyle"></span> <div class="summary"><p style="color: #dc143c; font-size: 8.5pt; font-weight: bold;">[Missing &lt;summary&gt; documentation for "N:Microsoft.Scripting.Hosting.Shell.Remote"]</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Classes</span></div><div id="ID0RBSection" class="collapsibleSection"><table class="members" id="classList"><tr><th class="iconColumn">
					 
				</th><th>Class</th><th>Description</th></tr><tr data="class; public"><td><img src="../icons/pubclass.gif" alt="Public class" title="Public class" /></td><td><a href="ae0e5e2a-5ad1-8d76-e0b7-9f9d8832827d.htm">ConsoleRestartManager</a></td><td><div class="summary">
             Supports detecting the remote runtime being killed, and starting up a new one.
             
             Threading model:
             
             ConsoleRestartManager creates a separate thread on which to create and execute the consoles. 
             There are usually atleast three threads involved:
             
             1. Main app thread: Instantiates ConsoleRestartManager and accesses its APIs. This thread has to stay 
                responsive to user input and so the ConsoleRestartManager APIs cannot be long-running or blocking.
                Since the remote runtime process can terminate asynchronously, the current RemoteConsoleHost can 
                change at any time (if auto-restart is enabled). The app should typically not care which instance of 
                RemoteConsoleHost is currently being used. The flowchart of this thread is:
                    Create ConsoleRestartManager
                    ConsoleRestartManager.Start
                    Loop:
                        Respond to user input | Send user input to console for execution | BreakExecution | RestartConsole | GetMemberNames
                    ConsoleRestartManager.Terminate
                TODO: Currently, BreakExecution and GetMemberNames are called by the main thread synchronously.
                Since they execute code in the remote runtime, they could take arbitrarily long. We should change
                this so that the main app thread can never be blocked indefinitely.
            
             2. Console thread: Dedicated thread for creating RemoteConsoleHosts and executing code (which could
                take a long time or block indefinitely).
                    Wait for ConsoleRestartManager.Start to be called
                    Loop:
                        Create RemoteConsoleHost
                        Wait for signal for:
                             Execute code | RestartConsole | Process.Exited
            
             3. CompletionPort async callbacks:
                    Process.Exited | Process.OutputDataReceived | Process.ErrorDataReceived
             
             4. Finalizer thred
                Some objects may have a Finalize method (which possibly calls Dispose). Not many (if any) types
                should have a Finalize method.
             
             </div></td></tr><tr data="class; public"><td><img src="../icons/pubclass.gif" alt="Public class" title="Public class" /></td><td><a href="b867173c-778a-76e4-9f90-da072efb4077.htm">RemoteCommandDispatcher</a></td><td><div class="summary">
            This allows the RemoteConsoleHost to abort a long-running operation. The RemoteConsoleHost itself
            does not know which ThreadPool thread might be processing the remote call, and so it needs
            cooperation from the remote runtime server.
            </div></td></tr><tr data="class; public"><td><img src="../icons/pubclass.gif" alt="Public class" title="Public class" /></td><td><a href="4d7ab5b8-e07c-ff48-a0ef-32c826d21028.htm">RemoteConsoleCommandLine</a></td><td><div class="summary">
            Customize the CommandLine for remote scenarios
            </div></td></tr><tr data="class; public"><td><img src="../icons/pubclass.gif" alt="Public class" title="Public class" /></td><td><a href="f828daf1-9ccf-970c-4f90-54658f5e460b.htm">RemoteConsoleHost</a></td><td><div class="summary">
            ConsoleHost where the ScriptRuntime is hosted in a separate process (referred to as the remote runtime server)
            
            The RemoteConsoleHost spawns the remote runtime server and specifies an IPC channel name to use to communicate
            with each other. The remote runtime server creates and initializes a ScriptRuntime and a ScriptEngine, and publishes
            it over the specified IPC channel at a well-known URI. Note that the RemoteConsoleHost cannot easily participate
            in the initialization of the ScriptEngine as classes like LanguageContext are not remotable.
            
            The RemoteConsoleHost then starts the interactive loop and executes commands on the ScriptEngine over the remoting channel.
            The RemoteConsoleHost listens to stdout of the remote runtime server and echos it locally to the user.
            </div></td></tr><tr data="class; public"><td><img src="../icons/pubclass.gif" alt="Public class" title="Public class" /></td><td><a href="3ac8a09f-18fa-4a1a-5130-d3242ae3395b.htm">RemoteRuntimeServer</a></td><td><div class="summary">
            The remote runtime server uses this class to publish an initialized ScriptEngine and ScriptRuntime 
            over a remoting channel.
            </div></td></tr><tr data="class; public"><td><img src="../icons/pubclass.gif" alt="Public class" title="Public class" /></td><td><a href="eac12032-59f7-5620-9a79-200ed2b51842.htm">RemoteRuntimeStartupException</a></td><td /></tr></table></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>